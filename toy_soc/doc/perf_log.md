# PERF LOG

## 2024-01-26

Dhrystone-O2:
    
    IPC:        0.872108
    DMIPS/MHz:  1.854519

基准版本，还有很多事情没做

- 没有任何分支预测
- ~~寄存器依赖检测过于悲观~~
- 乘除法流水线还没有打拍
- 还没有更新到双发射

分析log可以看到，ipc损失中
大部分都来自于真跳转，每次跳转引入1cycle损失。都是真跳转，隐藏不掉了。
小部分损失来自于dispatch阶段发生的资源冲突,冲突中有一部分是由于过于悲观的冲突判定导致的。


## 2024-01-28

Dhrystone-O2:

    IPC:        0.883625
    DMIPS/MHZ:  1.879009

- 更新rd锁定逻辑，不更新rd的指令将不会用对应的bit错误锁定某个rd。
- 更新rs依赖逻辑，不使用rs的指令将不会用对应的bit检测是否依赖某个rs。

- 还有部分悲观，如果后一个指令要写入rd，而前一个指令也要写入rd，后一个指令一定要等前一个写入完毕了再发射。

## 2024-01-30

### 21:00

Dhrystone-O2:
    
    IPC:        0.811429
    DMIPS/MHz:  1.725487

CoreMark 1.0 : 2429.787051 / GCC13.2.0 -O2 / STACK  
@1GHz

新增coremarck测试。
重构了fetch，重构的代码有额外的打拍，跳转损失从1拍变成2拍导致性能下降，待修复。


### 22:00

Dhrystone-O2:

    IPC:        0.883625
    DMIPS/MHZ:  1.879009

CoreMark 1.0 : 2684.157352 / GCC13.2.0 -O2 / STACK
@1GHz

移除额外的打拍，跳转损失恢复为1拍，性能恢复原状，但这个拍可能在物理实现遇到困难时需要恢复。
在没有分支预测的情况下，这一拍大概造成10%的性能损失。

